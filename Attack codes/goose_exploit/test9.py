from scapy.all import rdpcap, wrpcap, raw, Ether
import random

def increment_frame_length(pcap_file, output_file, increment_by, randomize=False):
    # Read the pcap file
    packets = rdpcap(pcap_file)

    # Iterate through each packet
    for packet in packets:
        # Convert packet to raw bytes
        packet_raw = raw(packet)
        
        # Increment the frame length by adding null or random values
        if randomize:
            increment_data = bytes(random.getrandbits(8) for _ in range(increment_by))
        else:
            increment_data = b'\x00' * increment_by
        
        # Modify the packet with the new data
        modified_packet = Ether(packet_raw + increment_data)
        
        # Update the packet in the list
        packet[Ether] = modified_packet

    # Write the modified packets to a new pcap file
    wrpcap(output_file, packets)

if __name__ == "__main__":
    # Input and output files
    input_pcap = 'Attack codes\goose_exploit\ids_bust_boolean.pcapng'
    output_pcap = 'injected_goose.pcap'
    
    # Number of bytes to increment by
    increment_by = 10
    
    # Whether to use random values (True) or null values (False)
    randomize = True

    increment_frame_length(input_pcap, output_pcap, increment_by, randomize)
