from scapy.all import rdpcap, wrpcap
from scapy.layers.l2 import Ether


def filter_packets(packet, src_mac, dst_mac):
    if packet.haslayer(Ether):
        if packet[Ether].src == src_mac and packet[Ether].dst == dst_mac:
            return True
    return False




file_path = "GG_SV_Train_Data.pcapng"

sv_packets = rdpcap(file_path)


filtered_packets = []

for packet in sv_packets:
    if filter_packets(packet, "b4:b1:5a:15:21:da", "01:0c:cd:04:00:01"):
        filtered_packets.append(packet)
        
        
wrpcap("filtered.pcapng", filtered_packets)