# NOTE: script is a basic handson of scapy by extraction of layers and some parameters
#        Can't extract Raw layer But all the other layers are extracted successfully.

from scapy.layers.inet import IP, TCP, Ether
from scapy.layers.l2 import Dot1Q
from scapy.all import *


path = "C:/Users/Shaheem Mushtaq/Desk env/Work ðŸ’¼/Internship/Attack codes/smv_exploit/SV_Normal_Traffic.cap"
packets = rdpcap(path)
packet = packets[0]

# print(packet.show())
packet.show()
# print('$'*50)
# print(packet.summary())

print(packet[Ether].src)
print(packet[Ether].dst)
print(packet[Ether].type)
print(packet[Dot1Q].prio)
print(packet[Dot1Q].vlan)
print(packet[Dot1Q].type)

# convert integer to hex
print(hex(packet[Dot1Q].type))
print(packet)
print(packet.load)

