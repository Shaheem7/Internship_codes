

# NOTE: This code is only applicable for SV_Normal_Traffic.cap file, where seqData's first 3 values are changed 


from scapy.all import rdpcap, wrpcap, raw, Ether, hexdump

# Read the packet from a pcap file
path = "SV_Normal_Traffic.cap"
packetss = rdpcap(path)
packets = packetss[0:30]





for pkt in packets:

    if pkt.haslayer('Raw'):
        # Convert packet to bytes
        bytes_data = raw(pkt)
    
        
        # Convert to bytearray for mutability
        byte_array = bytearray(bytes_data)
        
        
        #  Modify some bytes 

        # change the value of svID to '5001'
        # byte_array[37:38] = b'\x35'


        # change the value of smpCnt to 0x1234
        # byte_array[43:45] = b'\x12\x34'
        
        
        # change the value of seqData's first 3 values to 0x345678
        byte_array[56:59] = b'\x34\x56\x78'
        
        
        # Convert back to bytes
        modified_bytes_data = bytes(byte_array)

        # Reconstruct the packet from modified bytes
        modified_pkt = Ether(modified_bytes_data)

        # Save the modified packet back to a pcap file
        wrpcap("seqData_change.pcapng", modified_pkt, append=True)

        
        
        




